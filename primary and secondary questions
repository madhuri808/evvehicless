Que 1) List the top 3 and bottom 3 makers for the fiscal years 2023 and 2024 in
 terms of the number of 2-wheelers sold.

query :- top 3 
select s.maker , sum(electric_vehicles_sold) as sold_quantity
from electric_vehicle_sales_by_makers s
JOIN dim_date d
on d.date = s.date
where d.fiscal_year in(2023,2024)
and s.vehicle_category = "2-wheelers"
group by s.maker 
order by  sold_quantity desc
limit 3;

bottom 3 
select s.maker , sum(electric_vehicles_sold) as sold_quantity
from electric_vehicle_sales_by_makers s
JOIN dim_date d
on d.date = s.date
where d.fiscal_year in(2023,2024)
and s.vehicle_category = "2-wheelers"
group by s.maker 
order by  sold_quantity asc
limit 3; 

Que 2) Identify the top 5 states with the highest penetration rate in 2-wheeler
and 4-wheeler EV sales in FY 2024.

for 2-wheeler 

query :- select e.state , 
(sum(electric_vehicles_sold)/sum(total_vehicles_sold )*100) as penetration_rate
from electric_vehicle_sales_by_state e
join dim_date d
on d.date = e.date
where fiscal_year = 2024
and e.vehicle_category = "2-wheelers"
group by e.state
order by penetration_rate desc 
limit 5;


for 4-wheeler

select e.state , 
(sum(electric_vehicles_sold)/sum(total_vehicles_sold )*100) as penetration_rate
from electric_vehicle_sales_by_state e
join dim_date d
on d.date = e.date
where fiscal_year = 2024
and e.vehicle_category = "4-wheelers"
group by e.state
order by penetration_rate desc 
limit 5;


Que 3)List the states with negative penetration (decline) in EV sales from 2022
to 2024?

query :-with pct_change_previousyear as
(
select  e.state , (sum(electric_vehicles_sold)/sum(total_vehicles_sold)*100) as previoos_pent
from electric_vehicle_sales_by_state e
join dim_date d 
on d.date = e.date
where d.fiscal_year = 2023
group by e.state 
),
pct_change_currentyear as
(
select  e.state , (sum(electric_vehicles_sold)/sum(total_vehicles_sold)*100) as current_pent
from electric_vehicle_sales_by_state e
join dim_date d 
on d.date = e.date
where d.fiscal_year = 2024
group by e.state 
)
select c.state , c.current_pent - p.previoos_pent as pct_change
from pct_change_previousyear p
join pct_change_currentyear c 
on p.state = c.state 
where 
c.current_pent - p.previoos_pent < 0
order by pct_change;

Que 4)What are the quarterly trends based on sales volume for the top 5 EV
makers (4-wheelers) from 2022 to 2024?

query:- with cte1 as (
select e.maker ,d.quarter ,
sum(e.electric_vehicles_sold) as ev_sales,
row_number() over(partition by d.quarter order by sum(e.electric_vehicles_sold) desc) as rnk
from electric_vehicle_sales_by_makers e
join dim_date d on
d.date = e.date
where e.vehicle_category = "4-Wheelers"
group by e.maker ,d.quarter
)
select maker , quarter , ev_sales
from cte1
where rnk <= 5
order by quarter ,ev_sales desc;

Que 5)How do the EV sales and penetration rates in Delhi compare to
Karnataka for 2024?


